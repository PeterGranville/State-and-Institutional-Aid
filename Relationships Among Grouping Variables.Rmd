---
title: "Financial Aid Distributions: Relationships Among Grouping Variables"
author: "Peter Granville"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: united
    toc: true
    toc_float: true
  
---

```{r setup, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(scales)
library(plotly)
library(readxl)
library(tidyverse)
library(kableExtra)
    
```

```{r loadData, include=FALSE, warning=FALSE}

setwd("/Users/peter_granville/Net Price Equity/Data")

DIST.SECTOR3 <- read.csv("DIST-SECTOR3.csv", header=TRUE, check.names=FALSE)
targetLookup <- read_excel("Target-Lookup.xls") %>% select(-(`Section`)) %>% select(-(`Entry`))
axisBounds <- read.csv("Axis-Bounds.csv", header=TRUE, check.names=FALSE)

DIST.SECTOR3 <- DIST.SECTOR3 %>% mutate(
  `Row value` = ifelse(`Row name`=="Overall", "Overall", `Row value`)
)

```

```{r factorLists, include=FALSE, warning=FALSE}

levels.SectorValue <- c(
  "Total", 
  "Public 4-year",
  "Public 2-year", 
  "Other"
)

levels.RowName <- c(
  "Overall",
  "Income Quartile", 
  "Zero EFC Status", 
  "Pell Recipient Status", 
  "Parents' Highest Education Level", 
  "Race/Ethnicity", 
  "Institution HBCU Status", 
  "Institution MSI Status", 
  "Institution Selectivity", 
  "Institution State"
)

levels.RowValue <- c(
  
  "Total",
  "Overall",
  
  # Income Quartile
  "Top quartile",
  "Upper-middle quartile",
  "Lower-middle quartile",
  "Bottom quartile",
  
  # Institution HBCU Status
  "HBCUs",
  "Non-HBCUs",
  
  # Institution MSI Status
  "AAPISI",
  "HBCU",
  "HSI",
  "PBI",
  "Tribal college",
  "Other MSI",
  "Not an MSI",
  
  # Institution Selectivity
  "Very selective",
  "Moderately selective",  
  "Minimally selective",
  "Open admission",
  "Not a 4-year institution",
  
  # Institution State
  "Alabama",
  "Alaska",
  "Arizona",
  "Arkansas",
  "California",
  "Colorado",
  "Connecticut",
  "Delaware",
  "District of Columbia",
  "Florida",
  "Georgia",
  "Hawaii",
  "Idaho",
  "Illinois",
  "Indiana",
  "Iowa",
  "Kansas",
  "Kentucky",
  "Louisiana",
  "Maine",
  "Maryland",
  "Massachusetts",
  "Michigan",
  "Minnesota",
  "Mississippi",
  "Missouri",
  "Montana",
  "Nebraska",
  "Nevada",
  "New Hampshire",
  "New Jersey",
  "New Mexico",
  "New York",
  "North Carolina",
  "North Dakota",
  "Ohio",
  "Oklahoma",
  "Oregon",
  "Pennsylvania",
  "Puerto Rico",
  "Rhode Island",
  "South Carolina",
  "South Dakota",
  "Tennessee",
  "Texas",
  "Utah",
  "Vermont",
  "Virginia",
  "Washington",
  "West Virginia",
  "Wisconsin",
  "Wyoming",
  
  # Parents' Highest Education Level
  "College or beyond",
  "High school",
  "Middle school/junior high",
  
  # Pell Recipient Status
  "Pell recipient",
  "Not a Pell recipient",
  
  # Race/Ethnicity
  "White",
  "Hispanic or Latino",
  "Black or African American",
  "Asian",
  "Native American",
  "Native Hawaiian/Pacific Islander",
  "More than one race",
  
  # Zero EFC Status
  "Zero EFC",
  "Nonzero EFC"
)

levels.DistributionName <- c(
  "Income Quartile", 
  "Zero EFC Status", 
  "Pell Recipient Status", 
  "Parents' Highest Education Level", 
  "Race/Ethnicity", 
  "High School GPA",
  "Institution HBCU Status", 
  "Institution MSI Status", 
  "Institution Selectivity" 
)

levels.CategoryName <- c(
  levels.RowValue, c(
    # High School GPA
    "0.5 to 0.9", 
    "1.0 to 1.4", 
    "1.5 to 1.9", 
    "2.0 to 2.4", 
    "2.5 to 2.9", 
    "3.0 to 3.4", 
    "3.5 to 4.0"
  )
)

```

```{r chartFn2, include=FALSE, warning=FALSE}

chartFn2 <- function(distributionName, rowName){
  
  tempDF <- DIST.SECTOR3 %>% filter(
    `Distribution name`==distributionName, 
    `Row name`==rowName
  )
  
  tempDF <- tempDF %>% mutate(
    `Share` = `Share` / 100, 
    `Lower bound` = `Lower bound` / 100, 
    `Upper bound` = `Upper bound` / 100
  ) %>% mutate(
    `Share` = ifelse(`Share` < 0, 0, `Share`), 
    `Lower bound` = ifelse(`Lower bound` < 0, 0, `Lower bound`), 
    `Upper bound` = ifelse(`Upper bound` < 0, 0, `Upper bound`)
  ) %>% mutate(
    `Share` = ifelse(`Share` > 1, 1, `Share`), 
    `Lower bound` = ifelse(`Lower bound` > 1, 1, `Lower bound`), 
    `Upper bound` = ifelse(`Upper bound` > 1, 1, `Upper bound`)
  )
  
  if(rowName %in% c("Institution State", "Institution Selectivity")){
    if(rowName=="Institution State"){
      tempDF <- tempDF %>% filter(
        `Sector value` != "Other"
      ) %>% mutate(
        `Sector value` = factor(`Sector value`, levels=c(
            "Total", 
            "Public 4-year",
            "Public 2-year"
        ))
      )
    }
      if(rowName=="Institution Selectivity"){
      tempDF <- tempDF %>% filter(
        `Sector value` != "Public 2-year"
      ) %>% mutate(
        `Sector value` = factor(`Sector value`, levels=c(
            "Total", 
            "Public 4-year",
            "Other"
        ))
      )
    }
  }else{
    tempDF <- tempDF %>% mutate(
      `Sector value` = factor(`Sector value`, levels=levels.SectorValue), 
    )
  }
  
  tempDF <- tempDF %>% mutate(
    `Category name` = factor(`Category name`, levels=levels.CategoryName), 
    `Row name` = factor(`Row name`, levels=levels.RowName), 
    `Row value` = factor(`Row value`, levels=rev(levels.RowValue))
  ) %>% arrange(
    `Category name`,
    `Sector value`,
    `Row name`,
    `Row value`
  )
  
  tempDF <- tempDF %>% mutate(
    `For Tooltip`=paste(
      "Distribution variable: ", tempDF$`Distribution name`, '\n', 
      "Distribution value: ", tempDF$`Category name`, '\n', 
      "Selected group: ", tempDF$`Row value`, '\n', 
      "Sector: ", tempDF$`Sector value`, '\n', 
      "Estimate: ", percent(tempDF$`Share`, accuracy=0.1), '\n',
      "95% confidence interval: ", percent(tempDF$`Lower bound`, accuracy=0.1), " to ", percent(tempDF$`Upper bound`, accuracy=0.1), 
      sep=""
    )
  )
  
  plot1 <- ggplot(
    data=tempDF, mapping=aes(x=`Share`, y=`Row value`, fill=`Category name`, text=`For Tooltip`)
  ) + geom_bar(
    position="stack", stat="identity"
  ) + facet_wrap(
    `Sector value`~., strip.position = "top", ncol=1
  ) + labs(
    x=paste("Distribution of ", tempDF$`Distribution name`[1], " by ", tempDF$`Row name`[1]), y=""
  ) + theme(
    legend.position="top"
  ) + scale_x_continuous(labels=percent_format(accuracy=1))
  
  plot1 <- ggplotly(
    plot1, tooltip="text"
  ) %>% layout(legend = list(
    orientation = "h",   
    xanchor = "center",
    x = 0.5)             
  )
  
  return(plot1)
  
  rm(plot1, tempDF)
  
}

```

```{r textFn, include=FALSE, warning=FALSE}

textFn <- function(distributionName, rowName){
  
  # distributionName <- "Income Quartile"
  # rowName <- "Parents' Highest Education Level"
  # rowName <- "Overall"
  
  tempDF <- DIST.SECTOR3 %>% filter(
    `Distribution name`==distributionName, 
    `Row name`==rowName
  )
  
  if(rowName %in% c("Institution State", "Institution Selectivity")){
    if(rowName=="Institution State"){
      tempDF <- tempDF %>% filter(
        `Sector value` != "Other"
      ) %>% mutate(
        `Sector value` = factor(`Sector value`, levels=c(
            "Total", 
            "Public 4-year",
            "Public 2-year"
        ))
      )
    }
      if(rowName=="Institution Selectivity"){
      tempDF <- tempDF %>% filter(
        `Sector value` != "Public 2-year"
      ) %>% mutate(
        `Sector value` = factor(`Sector value`, levels=c(
            "Total", 
            "Public 4-year",
            "Other"
        ))
      )
    }
  }else{
    tempDF <- tempDF %>% mutate(
      `Sector value` = factor(`Sector value`, levels=levels.SectorValue), 
    )
  }
  
  tempDF <- tempDF %>% mutate(
    `Category name` = factor(`Category name`, levels=levels.CategoryName), 
    `Row name` = factor(`Row name`, levels=levels.RowName), 
    `Row value` = factor(`Row value`, levels=levels.RowValue)
  ) %>% arrange(
    `Category name`,
    `Sector value`,
    `Row name`,
    `Row value`
  )
  
  tempDF <- tempDF %>% mutate(
    `Count NA` = ifelse(is.na(`Share`), 1, 0)
  )
  agg1 <- aggregate(data=tempDF, `Count NA` ~ `Row value` + `Sector value`, FUN=sum)
  agg1.TOT <- agg1 %>% filter(`Sector value`=="Total")
  agg1.P4Y <- agg1 %>% filter(`Sector value`=="Public 4-year")
  agg1.P2Y <- agg1 %>% filter(`Sector value`=="Public 2-year")
  agg1.OTH <- agg1 %>% filter(`Sector value`=="Other")
  
  text1 <- paste("The NCES Datalab retrieval code for this chart is ", tempDF$`Source code`[1], ".", sep="")
  
  if(sum(agg1.TOT$`Count NA`) > 0){
    agg1.TOT <- agg1.TOT %>% filter(`Count NA` > 0)
    for(i in (1:length(agg1.TOT$`Row value`))){
      if(i==1){
        text2entries <- agg1.TOT$`Row value`[i]
      }else{
        text2entries <- paste(text2entries, ", ", agg1.TOT$`Row value`[i], sep="")
      }
    }
    text2 <- paste(
      "The following rows have missing data in the 'Total' subtable: ", 
      text2entries,
      ". ", 
      sep="")
    rm(text2entries, i)
  }else{
    text2 <- ""
  }
  
  if(sum(agg1.P4Y$`Count NA`) > 0){
    agg1.P4Y <- agg1.P4Y %>% filter(`Count NA` > 0)
    for(i in (1:length(agg1.P4Y$`Row value`))){
      if(i==1){
        text3entries <- agg1.P4Y$`Row value`[i]
      }else{
        text3entries <- paste(text3entries, ", ", agg1.P4Y$`Row value`[i], sep="")
      }
    }
    text3 <- paste(
      "The following rows have missing data in the 'Public 4-year' subtable: ", 
      text3entries,
      ". ", 
      sep="")
    rm(text3entries, i)
  }else{
    text3 <- ""
  }
    
  if(sum(agg1.P2Y$`Count NA`) > 0){
    agg1.P2Y <- agg1.P2Y %>% filter(`Count NA` > 0)
    for(i in (1:length(agg1.P2Y$`Row value`))){
      if(i==1){
        text4entries <- agg1.P2Y$`Row value`[i]
      }else{
        text4entries <- paste(text4entries, ", ", agg1.P2Y$`Row value`[i], sep="")
      }
    }
    text4 <- paste(
      "The following rows have missing data in the 'Public 2-year' subtable: ", 
      text4entries,
      ". ", 
      sep="")
    rm(text4entries, i)
  }else{
    text4 <- ""
  }
  
  if(sum(agg1.OTH$`Count NA`) > 0){
    agg1.OTH <- agg1.OTH %>% filter(`Count NA` > 0)
    for(i in (1:length(agg1.OTH$`Row value`))){
      if(i==1){
        text5entries <- agg1.OTH$`Row value`[i]
      }else{
        text5entries <- paste(text5entries, ", ", agg1.OTH$`Row value`[i], sep="")
      }
    }
    text5 <- paste(
      "The following rows have missing data in the 'Other' subtable: ", 
      text5entries,
      ". ", 
      sep="")
    rm(text5entries, i)
  }else{
    text5 <- ""
  }
  
  forPrint <- paste(text1, text2, text3, text4, text5, sep="")
  
  return(forPrint)
  
  rm(text1, text2, text3, text4, text5, forPrint, tempDF, agg1, agg1.TOT, agg1.P4Y, agg1.P2Y, agg1.OTH)
  
}

```

# Income Quartile

##  {.tabset}

### Overall

#### Distribution of Income Quartile

```{r chunk21285487, fig.height=4.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Income Quartile", rowName="Overall")
cat(textFn(distributionName="Income Quartile", rowName="Overall"))
```
 
### By Zero EFC Status

#### Distribution of Income Quartile by Zero EFC Status

```{r chunk61110952, fig.height=5.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Income Quartile", rowName="Zero EFC Status")
cat(textFn(distributionName="Income Quartile", rowName="Zero EFC Status"))
```
 
### By Pell Recipient Status

#### Distribution of Income Quartile by Pell Recipient Status

```{r chunk60880357, fig.height=5.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Income Quartile", rowName="Pell Recipient Status")
cat(textFn(distributionName="Income Quartile", rowName="Pell Recipient Status"))
```
 
### By Parents' Highest Education Level

#### Distribution of Income Quartile by Parents' Highest Education Level

```{r chunk50159729, fig.height=6, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Income Quartile", rowName="Parents' Highest Education Level")
cat(textFn(distributionName="Income Quartile", rowName="Parents' Highest Education Level"))
```
 
### By Race/Ethnicity

#### Distribution of Income Quartile by Race/Ethnicity

```{r chunk2673506, fig.height=8, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Income Quartile", rowName="Race/Ethnicity")
cat(textFn(distributionName="Income Quartile", rowName="Race/Ethnicity"))
```
 
### By Institution HBCU Status

#### Distribution of Income Quartile by Institution HBCU Status

```{r chunk81535522, fig.height=5.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Income Quartile", rowName="Institution HBCU Status")
cat(textFn(distributionName="Income Quartile", rowName="Institution HBCU Status"))
```
 
### By Institution MSI Status

#### Distribution of Income Quartile by Institution MSI Status

```{r chunk97252930, fig.height=8, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Income Quartile", rowName="Institution MSI Status")
cat(textFn(distributionName="Income Quartile", rowName="Institution MSI Status"))
```
 
### By Institution Selectivity

#### Distribution of Income Quartile by Institution Selectivity

```{r chunk88980865, fig.height=5.25, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Income Quartile", rowName="Institution Selectivity")
cat(textFn(distributionName="Income Quartile", rowName="Institution Selectivity"))
```
 
### By Institution State

#### Distribution of Income Quartile by Institution State

```{r chunk76352259, fig.height=40, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Income Quartile", rowName="Institution State")
cat(textFn(distributionName="Income Quartile", rowName="Institution State"))
```

## {-}

# Zero EFC Status

##  {.tabset}

### Overall

#### Distribution of Zero EFC Status

```{r chunk52557812, fig.height=4.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Zero EFC Status", rowName="Overall")
cat(textFn(distributionName="Zero EFC Status", rowName="Overall"))
```
 
### By Income Quartile

#### Distribution of Zero EFC Status by Income Quartile

```{r chunk62877694, fig.height=6.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Zero EFC Status", rowName="Income Quartile")
cat(textFn(distributionName="Zero EFC Status", rowName="Income Quartile"))
```
 
### By Pell Recipient Status

#### Distribution of Zero EFC Status by Pell Recipient Status

```{r chunk22397449, fig.height=5.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Zero EFC Status", rowName="Pell Recipient Status")
cat(textFn(distributionName="Zero EFC Status", rowName="Pell Recipient Status"))
```
 
### By Parents' Highest Education Level

#### Distribution of Zero EFC Status by Parents' Highest Education Level

```{r chunk1739577, fig.height=6, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Zero EFC Status", rowName="Parents' Highest Education Level")
cat(textFn(distributionName="Zero EFC Status", rowName="Parents' Highest Education Level"))
```
 
### By Race/Ethnicity

#### Distribution of Zero EFC Status by Race/Ethnicity

```{r chunk93806167, fig.height=8, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Zero EFC Status", rowName="Race/Ethnicity")
cat(textFn(distributionName="Zero EFC Status", rowName="Race/Ethnicity"))
```
 
### By Institution HBCU Status

#### Distribution of Zero EFC Status by Institution HBCU Status

```{r chunk60057384, fig.height=5.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Zero EFC Status", rowName="Institution HBCU Status")
cat(textFn(distributionName="Zero EFC Status", rowName="Institution HBCU Status"))
```
 
### By Institution MSI Status

#### Distribution of Zero EFC Status by Institution MSI Status

```{r chunk13462969, fig.height=8, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Zero EFC Status", rowName="Institution MSI Status")
cat(textFn(distributionName="Zero EFC Status", rowName="Institution MSI Status"))
```
 
### By Institution Selectivity

#### Distribution of Zero EFC Status by Institution Selectivity

```{r chunk21818645, fig.height=5.25, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Zero EFC Status", rowName="Institution Selectivity")
cat(textFn(distributionName="Zero EFC Status", rowName="Institution Selectivity"))
```
 
### By Institution State

#### Distribution of Zero EFC Status by Institution State

```{r chunk66404237, fig.height=40, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Zero EFC Status", rowName="Institution State")
cat(textFn(distributionName="Zero EFC Status", rowName="Institution State"))
```

## {-}

# Pell Recipient Status

##  {.tabset}

### Overall

#### Distribution of Pell Recipient Status

```{r chunk50423723, fig.height=4.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Pell Recipient Status", rowName="Overall")
cat(textFn(distributionName="Pell Recipient Status", rowName="Overall"))
```
 
### By Income Quartile

#### Distribution of Pell Recipient Status by Income Quartile

```{r chunk10341132, fig.height=6.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Pell Recipient Status", rowName="Income Quartile")
cat(textFn(distributionName="Pell Recipient Status", rowName="Income Quartile"))
```
 
### By Zero EFC Status

#### Distribution of Pell Recipient Status by Zero EFC Status

```{r chunk87337223, fig.height=5.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Pell Recipient Status", rowName="Zero EFC Status")
cat(textFn(distributionName="Pell Recipient Status", rowName="Zero EFC Status"))
```
 
### By Parents' Highest Education Level

#### Distribution of Pell Recipient Status by Parents' Highest Education Level

```{r chunk20513581, fig.height=6, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Pell Recipient Status", rowName="Parents' Highest Education Level")
cat(textFn(distributionName="Pell Recipient Status", rowName="Parents' Highest Education Level"))
```
 
### By Race/Ethnicity

#### Distribution of Pell Recipient Status by Race/Ethnicity

```{r chunk21042589, fig.height=8, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Pell Recipient Status", rowName="Race/Ethnicity")
cat(textFn(distributionName="Pell Recipient Status", rowName="Race/Ethnicity"))
```
 
### By Institution HBCU Status

#### Distribution of Pell Recipient Status by Institution HBCU Status

```{r chunk8637916, fig.height=5.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Pell Recipient Status", rowName="Institution HBCU Status")
cat(textFn(distributionName="Pell Recipient Status", rowName="Institution HBCU Status"))
```
 
### By Institution MSI Status

#### Distribution of Pell Recipient Status by Institution MSI Status

```{r chunk34446016, fig.height=8, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Pell Recipient Status", rowName="Institution MSI Status")
cat(textFn(distributionName="Pell Recipient Status", rowName="Institution MSI Status"))
```
 
### By Institution Selectivity

#### Distribution of Pell Recipient Status by Institution Selectivity

```{r chunk93142296, fig.height=5.25, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Pell Recipient Status", rowName="Institution Selectivity")
cat(textFn(distributionName="Pell Recipient Status", rowName="Institution Selectivity"))
```
 
### By Institution State

#### Distribution of Pell Recipient Status by Institution State

```{r chunk53915545, fig.height=40, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Pell Recipient Status", rowName="Institution State")
cat(textFn(distributionName="Pell Recipient Status", rowName="Institution State"))
```

## {-}

# Parents' Highest Education Level

##  {.tabset}

### Overall

#### Distribution of Parents' Highest Education Level

```{r chunk50981952, fig.height=4.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Parents' Highest Education Level", rowName="Overall")
cat(textFn(distributionName="Parents' Highest Education Level", rowName="Overall"))
```
 
### By Income Quartile

#### Distribution of Parents' Highest Education Level by Income Quartile

```{r chunk10634790, fig.height=6.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Parents' Highest Education Level", rowName="Income Quartile")
cat(textFn(distributionName="Parents' Highest Education Level", rowName="Income Quartile"))
```
 
### By Zero EFC Status

#### Distribution of Parents' Highest Education Level by Zero EFC Status

```{r chunk7337061, fig.height=5.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Parents' Highest Education Level", rowName="Zero EFC Status")
cat(textFn(distributionName="Parents' Highest Education Level", rowName="Zero EFC Status"))
```
 
### By Pell Recipient Status

#### Distribution of Parents' Highest Education Level by Pell Recipient Status

```{r chunk83980521, fig.height=5.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Parents' Highest Education Level", rowName="Pell Recipient Status")
cat(textFn(distributionName="Parents' Highest Education Level", rowName="Pell Recipient Status"))
```
 
### By Race/Ethnicity

#### Distribution of Parents' Highest Education Level by Race/Ethnicity

```{r chunk20888415, fig.height=8, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Parents' Highest Education Level", rowName="Race/Ethnicity")
cat(textFn(distributionName="Parents' Highest Education Level", rowName="Race/Ethnicity"))
```
 
### By Institution HBCU Status

#### Distribution of Parents' Highest Education Level by Institution HBCU Status

```{r chunk11742342, fig.height=5.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Parents' Highest Education Level", rowName="Institution HBCU Status")
cat(textFn(distributionName="Parents' Highest Education Level", rowName="Institution HBCU Status"))
```
 
### By Institution MSI Status

#### Distribution of Parents' Highest Education Level by Institution MSI Status

```{r chunk449097, fig.height=8, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Parents' Highest Education Level", rowName="Institution MSI Status")
cat(textFn(distributionName="Parents' Highest Education Level", rowName="Institution MSI Status"))
```
 
### By Institution Selectivity

#### Distribution of Parents' Highest Education Level by Institution Selectivity

```{r chunk55869199, fig.height=5.25, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Parents' Highest Education Level", rowName="Institution Selectivity")
cat(textFn(distributionName="Parents' Highest Education Level", rowName="Institution Selectivity"))
```
 
### By Institution State

#### Distribution of Parents' Highest Education Level by Institution State

```{r chunk40402759, fig.height=40, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Parents' Highest Education Level", rowName="Institution State")
cat(textFn(distributionName="Parents' Highest Education Level", rowName="Institution State"))
```

## {-}

# Race/Ethnicity

##  {.tabset}

### Overall

#### Distribution of Race/Ethnicity

```{r chunk83424412, fig.height=4.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Race/Ethnicity", rowName="Overall")
cat(textFn(distributionName="Race/Ethnicity", rowName="Overall"))
```
 
### By Income Quartile

#### Distribution of Race/Ethnicity by Income Quartile

```{r chunk97835230, fig.height=6.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Race/Ethnicity", rowName="Income Quartile")
cat(textFn(distributionName="Race/Ethnicity", rowName="Income Quartile"))
```
 
### By Zero EFC Status

#### Distribution of Race/Ethnicity by Zero EFC Status

```{r chunk43878198, fig.height=5.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Race/Ethnicity", rowName="Zero EFC Status")
cat(textFn(distributionName="Race/Ethnicity", rowName="Zero EFC Status"))
```
 
### By Pell Recipient Status

#### Distribution of Race/Ethnicity by Pell Recipient Status

```{r chunk62457188, fig.height=5.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Race/Ethnicity", rowName="Pell Recipient Status")
cat(textFn(distributionName="Race/Ethnicity", rowName="Pell Recipient Status"))
```
 
### By Parents' Highest Education Level

#### Distribution of Race/Ethnicity by Parents' Highest Education Level

```{r chunk37090882, fig.height=6.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Race/Ethnicity", rowName="Parents' Highest Education Level")
cat(textFn(distributionName="Race/Ethnicity", rowName="Parents' Highest Education Level"))
```
 
### By Institution HBCU Status

#### Distribution of Race/Ethnicity by Institution HBCU Status

```{r chunk5361692, fig.height=5.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Race/Ethnicity", rowName="Institution HBCU Status")
cat(textFn(distributionName="Race/Ethnicity", rowName="Institution HBCU Status"))
```
 
### By Institution MSI Status

#### Distribution of Race/Ethnicity by Institution MSI Status

```{r chunk78950206, fig.height=8.2, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Race/Ethnicity", rowName="Institution MSI Status")
cat(textFn(distributionName="Race/Ethnicity", rowName="Institution MSI Status"))
```
 
### By Institution Selectivity

#### Distribution of Race/Ethnicity by Institution Selectivity

```{r chunk36318482, fig.height=5.45, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Race/Ethnicity", rowName="Institution Selectivity")
cat(textFn(distributionName="Race/Ethnicity", rowName="Institution Selectivity"))
```
 
### By Institution State

#### Distribution of Race/Ethnicity by Institution State

```{r chunk5826190, fig.height=40.2, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Race/Ethnicity", rowName="Institution State")
cat(textFn(distributionName="Race/Ethnicity", rowName="Institution State"))
```

## {-}

# Institution HBCU Status

##  {.tabset}

### Overall

#### Distribution of Institution HBCU Status

```{r chunk56654027, fig.height=4.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution HBCU Status", rowName="Overall")
cat(textFn(distributionName="Institution HBCU Status", rowName="Overall"))
```
 
### By Income Quartile

#### Distribution of Institution HBCU Status by Income Quartile

```{r chunk62720479, fig.height=6.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution HBCU Status", rowName="Income Quartile")
cat(textFn(distributionName="Institution HBCU Status", rowName="Income Quartile"))
```
 
### By Zero EFC Status

#### Distribution of Institution HBCU Status by Zero EFC Status

```{r chunk76775898, fig.height=5.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution HBCU Status", rowName="Zero EFC Status")
cat(textFn(distributionName="Institution HBCU Status", rowName="Zero EFC Status"))
```
 
### By Pell Recipient Status

#### Distribution of Institution HBCU Status by Pell Recipient Status

```{r chunk34456158, fig.height=5.5, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution HBCU Status", rowName="Pell Recipient Status")
cat(textFn(distributionName="Institution HBCU Status", rowName="Pell Recipient Status"))
```
 
### By Parents' Highest Education Level

#### Distribution of Institution HBCU Status by Parents' Highest Education Level

```{r chunk4705165, fig.height=6, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution HBCU Status", rowName="Parents' Highest Education Level")
cat(textFn(distributionName="Institution HBCU Status", rowName="Parents' Highest Education Level"))
```
 
### By Race/Ethnicity

#### Distribution of Institution HBCU Status by Race/Ethnicity

```{r chunk81936383, fig.height=8, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution HBCU Status", rowName="Race/Ethnicity")
cat(textFn(distributionName="Institution HBCU Status", rowName="Race/Ethnicity"))
```
 
### By Institution MSI Status

#### Distribution of Institution HBCU Status by Institution MSI Status

```{r chunk96629739, fig.height=8, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution HBCU Status", rowName="Institution MSI Status")
cat(textFn(distributionName="Institution HBCU Status", rowName="Institution MSI Status"))
```
 
### By Institution Selectivity

#### Distribution of Institution HBCU Status by Institution Selectivity

```{r chunk57559333, fig.height=5.25, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution HBCU Status", rowName="Institution Selectivity")
cat(textFn(distributionName="Institution HBCU Status", rowName="Institution Selectivity"))
```
 
### By Institution State

#### Distribution of Institution HBCU Status by Institution State

```{r chunk2439493, fig.height=40, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution HBCU Status", rowName="Institution State")
cat(textFn(distributionName="Institution HBCU Status", rowName="Institution State"))
```

## {-}

# Institution MSI Status

##  {.tabset}

### Overall

#### Distribution of Institution MSI Status

```{r chunk41735544, fig.height=4.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution MSI Status", rowName="Overall")
cat(textFn(distributionName="Institution MSI Status", rowName="Overall"))
```
 
### By Income Quartile

#### Distribution of Institution MSI Status by Income Quartile

```{r chunk24690406, fig.height=6.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution MSI Status", rowName="Income Quartile")
cat(textFn(distributionName="Institution MSI Status", rowName="Income Quartile"))
```
 
### By Zero EFC Status

#### Distribution of Institution MSI Status by Zero EFC Status

```{r chunk36081062, fig.height=5.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution MSI Status", rowName="Zero EFC Status")
cat(textFn(distributionName="Institution MSI Status", rowName="Zero EFC Status"))
```
 
### By Pell Recipient Status

#### Distribution of Institution MSI Status by Pell Recipient Status

```{r chunk90438112, fig.height=5.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution MSI Status", rowName="Pell Recipient Status")
cat(textFn(distributionName="Institution MSI Status", rowName="Pell Recipient Status"))
```
 
### By Parents' Highest Education Level

#### Distribution of Institution MSI Status by Parents' Highest Education Level

```{r chunk62713825, fig.height=6.2, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution MSI Status", rowName="Parents' Highest Education Level")
cat(textFn(distributionName="Institution MSI Status", rowName="Parents' Highest Education Level"))
```
 
### By Race/Ethnicity

#### Distribution of Institution MSI Status by Race/Ethnicity

```{r chunk57783129, fig.height=8.2, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution MSI Status", rowName="Race/Ethnicity")
cat(textFn(distributionName="Institution MSI Status", rowName="Race/Ethnicity"))
```
 
### By Institution HBCU Status

#### Distribution of Institution MSI Status by Institution HBCU Status

```{r chunk20928641, fig.height=5.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution MSI Status", rowName="Institution HBCU Status")
cat(textFn(distributionName="Institution MSI Status", rowName="Institution HBCU Status"))
```
 
### By Institution Selectivity

#### Distribution of Institution MSI Status by Institution Selectivity

```{r chunk37268494, fig.height=5.45, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution MSI Status", rowName="Institution Selectivity")
cat(textFn(distributionName="Institution MSI Status", rowName="Institution Selectivity"))
```
 
### By Institution State

#### Distribution of Institution MSI Status by Institution State

```{r chunk35218199, fig.height=40.2, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution MSI Status", rowName="Institution State")
cat(textFn(distributionName="Institution MSI Status", rowName="Institution State"))
```

## {-}

# Institution Selectivity

##  {.tabset}

### Overall

#### Distribution of Institution Selectivity

```{r chunk86891062, fig.height=4.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution Selectivity", rowName="Overall")
cat(textFn(distributionName="Institution Selectivity", rowName="Overall"))
```
 
### By Income Quartile

#### Distribution of Institution Selectivity by Income Quartile

```{r chunk24159689, fig.height=6.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution Selectivity", rowName="Income Quartile")
cat(textFn(distributionName="Institution Selectivity", rowName="Income Quartile"))
```
 
### By Zero EFC Status

#### Distribution of Institution Selectivity by Zero EFC Status

```{r chunk71251531, fig.height=5.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution Selectivity", rowName="Zero EFC Status")
cat(textFn(distributionName="Institution Selectivity", rowName="Zero EFC Status"))
```
 
### By Pell Recipient Status

#### Distribution of Institution Selectivity by Pell Recipient Status

```{r chunk76016375, fig.height=5.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution Selectivity", rowName="Pell Recipient Status")
cat(textFn(distributionName="Institution Selectivity", rowName="Pell Recipient Status"))
```
 
### By Parents' Highest Education Level

#### Distribution of Institution Selectivity by Parents' Highest Education Level

```{r chunk21428687, fig.height=6.2, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution Selectivity", rowName="Parents' Highest Education Level")
cat(textFn(distributionName="Institution Selectivity", rowName="Parents' Highest Education Level"))
```
 
### By Race/Ethnicity

#### Distribution of Institution Selectivity by Race/Ethnicity

```{r chunk51678473, fig.height=8.2, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution Selectivity", rowName="Race/Ethnicity")
cat(textFn(distributionName="Institution Selectivity", rowName="Race/Ethnicity"))
```
 
### By Institution HBCU Status

#### Distribution of Institution Selectivity by Institution HBCU Status

```{r chunk41283899, fig.height=5.7, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution Selectivity", rowName="Institution HBCU Status")
cat(textFn(distributionName="Institution Selectivity", rowName="Institution HBCU Status"))
```
 
### By Institution MSI Status

#### Distribution of Institution Selectivity by Institution MSI Status

```{r chunk65594084, fig.height=8.2, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution Selectivity", rowName="Institution MSI Status")
cat(textFn(distributionName="Institution Selectivity", rowName="Institution MSI Status"))
```
 
### By Institution State

#### Distribution of Institution Selectivity by Institution State

```{r chunk60829118, fig.height=40.2, fig.width=8, warning=FALSE, results = 'asis'} 
chartFn2(distributionName="Institution Selectivity", rowName="Institution State")
cat(textFn(distributionName="Institution Selectivity", rowName="Institution State"))
```

## {-}


